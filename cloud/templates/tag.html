{% extends "base.html" %}

{% block functions %}
function pollProgress() {
  $.getJSON('/ajax/progress', {tag_id: {{ tag_id }}},
            function(data) {
              $('#progressbar').progressbar("option",
                                            "value",
                                            data.progress);
            });
}
function loop() {
  pollProgress();
  setTimeout("loop()", 3000);
}
{% endblock %}
{% block script %}
$('img').fadeIn(800);
$(document).keypress(function(event) {
  {% for i, u in bigimage_urls %}
  if (event.which == '{{ i }}') {
    location.href = "{{ u }}";
  }
  {% endfor %}
});
$('div.pager').wrap('<center><h4></h4></center>');
$('#progressbar').progressbar({ value: 0});
loop();
{% endblock %}
{% block title %}{{ name }}{% endblock %}

{% block content %}
<center><h1>{{ name }}</h1></center>
<center>
  <table id="photos" border="0">
  {% for row in pics %}
    <tr>
    {% for image in row %}
      <td>
        <a href="/tag/{{ tag_id }}/{{ page_id }}/{{ image }}">
          <img src='/image/{{image}}/2'>
        </a>
      </td>
    {% endfor %}
    </tr>
  {% endfor %}
  </table>
</center>
<div class="pager">
  {% for page, alt, url in pages %}
  <a class="pager" alt="{{ alt }}" href="{{ url }}">{{ page }}</a>
  {% endfor %}
</div>
<div id="progressbar"></div>
{% endblock %}
